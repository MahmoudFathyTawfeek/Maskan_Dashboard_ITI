<div>

  <!-- Main Content -->
  <div class="col-md-10 col-12 p-4 w-100 ">
    <div class="row justify-content-between align-items-center mb-3">
      <h3 class="col-md-8 text-primary">Update Listing</h3>
      <button class="btn btn-primary col-md-2" [routerLink]="['/listings']">Back</button>
    </div>

    <form [formGroup]="listingForm" (ngSubmit)="updateListing()">

      <label>Title:</label>
      <input formControlName="title" class="form-control mb-2" />

      <label>Host:</label>
      <select formControlName="hostId" class="form-select mb-2">
        <option *ngFor="let host of hosts" [value]="host._id">{{ host.userName }}</option>
      </select>

      <label>Description:</label>
      <textarea formControlName="description" class="form-control mb-2"></textarea>

      <label>Price per Night:</label>
      <input type="number" formControlName="pricePerNight" class="form-control mb-2" />

      <label>Category:</label>
      <select formControlName="categoryId" class="form-select mb-2">
        <option *ngFor="let cat of categories" [value]="cat._id">{{ cat.name }}</option>
      </select>

      <label>Location Type:</label>
      <select formControlName="locationType" class="form-select mb-2">
        <option *ngFor="let loc of locationTypes" [value]="loc.toLowerCase()">{{ loc }}</option>
      </select>

      <label>Governorate:</label>
      <select formControlName="governorate" class="form-select mb-2">
        <option *ngFor="let gov of listingForm.get('governorate')?.value | keyvalue" [value]="gov">{{ gov }}</option>
        <option *ngFor="let gov of [
          'Cairo','Giza','Alexandria','Qalyubia','PortSaid','Suez','Dakahlia','Sharqia',
          'Gharbia','Monufia','Beheira','KafrElSheikh','Fayoum','BeniSuef','Minya','Assiut',
          'Sohag','Qena','Luxor','Aswan','RedSea','NewValley','Matrouh','NorthSinai','SouthSinai'
        ]" [value]="gov">{{ gov }}</option>
      </select>

      <label>Location Address:</label>
      <input formControlName="location" class="form-control mb-2" />

    <label>Amenities:</label>
<div class="row mb-3">
  <div class="col-md-6 mb-2" *ngFor="let amenity of amenitiesList">
    <div class="form-check d-flex align-items-center gap-2 p-2 border rounded">
      <input class="form-check-input" type="checkbox"
             [checked]="amenitiesId.value.includes(amenity._id)"
             (change)="toggleAmenity(amenity._id)" />
      <img *ngIf="amenity.icon" [src]="amenity.icon" alt="{{amenity.name}}" width="24" height="24">
      <label class="form-check-label mb-0">{{ amenity.name }}</label>
    </div>
  </div>
</div>


      <label>Max Guests:</label>
      <input type="number" formControlName="maxGuests" class="form-control mb-2" />

      <label>Photos:</label>
      <div *ngFor="let photo of photos.controls; let i = index" class="d-flex gap-2 mb-2">
        <input [formControl]="$any(photo)" class="form-control" placeholder="Photo URL" />
        <button type="button" class="btn btn-danger btn-sm" (click)="removePhotoField(i)">Remove</button>
      </div>
      <button type="button" class="btn btn-primary btn-sm mb-3" (click)="addPhotoField()">Add Photo</button>

      <label>Average Rating:</label>
      <input type="number" formControlName="averageRating" class="form-control mb-2" />

      <div class="form-check mb-3">
        <input type="checkbox" formControlName="isApproved" class="form-check-input" />
        <label class="form-check-label">Approved</label>
      </div>

      <button type="submit" class="btn btn-success">Update Listing</button>
    </form>
  </div>
</div>
